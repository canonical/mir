name: TICS

on:
#  push:
#    branches:
#    - main
  schedule:
  # 5:04 on a Wednesday
  - cron: 5 4 * * 3
  workflow_dispatch:

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}

jobs:
  Prepare:
    uses: ./.github/workflows/tics-run.yml
    secrets: inherit
    with:
      step: prepare
      calc: PREPARE,CHANGEDFILES,BUILDRELATIONS,INCLUDERELATIONS,LOC

  Finalize:
    if: ${{ always() }}
    needs:
    - Prepare
    uses: ./.github/workflows/tics-run.yml
    secrets: inherit
    with:
      step: finalize
      calc: FINALIZE,POSTANA
